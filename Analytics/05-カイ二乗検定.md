# カイ二乗検定

## カイ二乗検定の概要

* ２郡の割合の差が偶然ではなく有意な差であるかどうかを検証する方法
* 観測度数と期待度数を比べる

## 観測度数と期待度数

### 観測度数

* 実際に観測された度数

### 期待度数

* ２群間の割合に差がないと仮定した場合に期待される度数

## 観測度数と期待度数の例

離職率と残業の有無を表す観測度数と期待度数

|      観測度数      | 残業あり | 残業なし | 合計  |
| :----------------: | :------: | :------: | :---: |
|    **離職した**    |    60    |    60    |  120  |
| **離職していない** |   140    |   240    |  380  |
|      **合計**      |   200    |   300    |  500  |

|      期待度数      | 残業あり | 残業なし | 合計  |
| :----------------: | :------: | :------: | :---: |
|    **離職した**    |    48    |    72    |  120  |
| **離職していない** |   152    |   228    |  380  |
|      **合計**      |   200    |   300    |  500  |

## カイ二乗値

* 観測度数と期待度数のズレの大きさを表す値
* 期待度数と観測度数が完全に一致すれば、カイ二乗値はゼロになる
* ズレが大きくなればカイ二乗値は大きくなる
* カイ二乗値 = (((観測度数 - 期待度数)の２乗)÷期待度数) の総和

## カイ二乗分布

* 帰無仮説（２群間に差はない）を前提とした時にカイ二乗値がとりうる分布
* 自由度によって分布の形が決まる

## 自由度

* ある代表値（平均値）や合計値があるときに自由に値をとれる数
* 自由に決められる値がいくつあるか
* 最後の1つは平均値や合計値に合わせて自動的に決まるため **サンプルサイズ - 1** となる

## 自由度計算の例

下図の場合
  * 科目の自由度 = (3 - 1) = 2
  * 合否の自由度 = (2 - 1) = 1
  * 全体の自由度 = 2 × 1 = 2

よって自由度は2となる

  | 合否→<br>↓科目 | 合格  | 不合格 | 合計  |
  | :------------: | :---: | :----: | :---: |
  |    **国語**    |   5   |   5    |  10   |
  |    **数学**    |   6   |   4    |  10   |
  |    **英語**    |   8   |   2    |  10   |
  |    **合計**    |  19   |   11   |  30   |
